# 操作系统设计

## Overview

复习

- 操作系统设计：一组对象 + 访问对象的 API
- 操作系统实现：一个 C 程序实现上面的设计

------

本次课回答的问题

- **Q**: 操作系统到底应该提供什么对象和 API？

------

本次课主要内容

- Micro/Exo/Unikernel

## 一、操作系统里到底该有什么？

### 1、2022.4.25 小学生又出新产品了

这次支持了分页和图形界面 (似乎是搬运了一些素材？)

- L2: tty 和 fb 驱动 (tty 是逐像素绘制的)
- L3: 9 个系统调用 (kputc, fork, wait, exit, kill, mmap, ...)

### 2、莫要慌：你们是大学生啊 😂

![img](http://jyywiki.cn/pages/OS/img/eager-for-power.jpg)

### 3、上课谈的不能称为真正的 “操作系统”

发扬大学生 RTFM & RTFSC 的光荣传统

- 能够意识到这一点的中/小学生就能成为顶级的程序员

------

[The Open Group Base Specifications Issue 7 (2018 Ed.)](https://pubs.opengroup.org/onlinepubs/9699919799/mindex.html)

- XBD: Base Definitions
- XSH: System Interfaces
- XCU: Shell & Utilities
- XRAT: Rationale
    - 这是非常关键的：不仅告诉 “是什么”，还有 “为什么”

------

[Windows API Index](https://docs.microsoft.com/en-us/windows/win32/apiindex/windows-api-list)

- 和 POSIX 相当不同的一组设计
- “工业” v.s. “黑客” (PowerShell v.s. bash)

### 4、冰山的一角

API 意味着可以互相模拟

- Windows Subsystem for Linux (WSL)，大家都在用
    - WSL1: 直接用 Windows 加载 ELF 文件
    - WSL2: 虚拟机
- Linux Subsystem for Windows (Wine)

![img](http://jyywiki.cn/pages/OS/img/wined3.jpg)