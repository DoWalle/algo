[781. 森林中的兔子](https://leetcode-cn.com/problems/rabbits-in-forest/)

## 方法：数学推理

**两只相同颜色的兔子看到的其他同色兔子数必然是相同的**。反之，若两只兔子看到的其他同色兔子数不同，那么这两只兔子颜色也不同。

因此，将 answers 中值相同的元素分为一组，对于每一组，计算出兔子的最少数量，然后将所有组的计算结果累加，就是最终的答案。

### 问题转化为：如何计算出每个回答组的最少数量

题目中有个关键的隐藏条件：**有些兔子并没有被提问到**

举个例子：

- 回答 5 的次数有 3 次，当一只兔子回答 5 时表明，包括它自身相同颜色的兔子有 5 + 1 只。回答了 3 次，还有 3 只兔子没被提问到。至少需要 5 + 1 只。
- 回答 5 的次数有 6 次，每只兔子都回答了。至少需要 5 + 1 只。
- 回答 5 的次数有 8 次，表明回答 5 的这群兔子里面有「大于 1 种」颜色的兔子（因为，同种颜色最多回答 6 次）。那么怎么得到这堆兔子的颜色种类数，**8 / 6 并向上取整**，有 2 种。假设第一种有 6 只都被提问到了，第二种有 2 只被提问到了，但是这两只都回答的是 5，表明还有 4 只没被提问到。因此，至少需要 2 * (5 + 1) 只。

更一般的公式：

$$
每个回答组数量 = \frac{回答次数相同的数量}{同种颜色回答次数}(向上取整) * 同种颜色回答次数 \\ \\
同种颜色回答次数 = 某兔子回答数 + 1
$$

向上取整公式：向上取整`a / b` => 向下取整 `(a + b - 1) / b `

哈希表记录分组信息，k 为某兔子回答数，v 为有多少只兔子回答了 k。因此，**回答次数相同的数量 = v，同种颜色回答次数 = k + 1** 

$$
\begin{align*}
每个回答组数量 &= \frac{v}{k+1}(向上取整)*(k+1) \\\\
  &= \frac{v+k+1-1}{k+1}(向下取整)*(k+1) \\\\
  &= \frac{v+k}{k+1}(向下取整)*(k+1)
\end{align*}
$$

注意：不可再约分，因为涉及向下取整

- 时间复杂度：`O(n)`
- 空间复杂度：`O(n)`

```c++
class Solution {
public:
    int numRabbits(vector<int>& answers) {
        unordered_map<int, int> counter;
        for (int num : answers) {
            counter[num]++;
        }
        int cnt = 0;
        for (auto& [k, v] : counter) {
            cnt += (k + v) / (k + 1) * (k + 1);
        }
        return cnt;
    }
};
```

