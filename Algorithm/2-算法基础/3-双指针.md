# 双指针

参考：[双指针技巧直接秒杀五道算法题](https://mp.weixin.qq.com/s/Nh6jxQtO-xOT_WuX-B5w3Q)

双指针是一种时间复杂度 `O(n)`，空间复杂度 `O(1)` 的算法

## 一、快慢双指针

快慢指针一般都初始化指向链表的头结点`head`，前进时快指针`fast`在前，慢指针`slow`在后，巧妙解决一些链表中的问题

### 1、寻找链表的中点

快指针一次前进两步，慢指针一次前进一步，当快指针到达链表尽头时，慢指针就处于链表的中间位置。

- 当链表的长度是奇数时，`slow`恰巧停在中点位置；
- 如果长度是偶数，`slow`最终的位置是中间偏右

```c++
class Solution {
public:
    ListNode* middleNode(ListNode* head) {
        ListNode* slow = head;
        ListNode* fast = head;
        while (fast != nullptr && fast->next != nullptr) {
            fast = fast->next->next;
            slow = slow->next;
        }
        return slow;
    }
};
```

例题：[876-[快慢双指针]-链表的中间结点](../1-数据结构/例题-链表/876-[快慢双指针]-链表的中间结点.md)



寻找链表中点的一个重要作用是对链表进行归并排序。「还没理解」

回想数组的归并排序：求中点索引递归地把数组二分，最后合并两个有序数组。对于链表，合并两个有序链表是很简单的，难点就在于二分。

### 2、环问题

#### 1）是否有环

[141-[环问题-是否有环]-环形链表](./例题-双指针/141-[环问题-是否有环]-环形链表.md)

经典解法就是用快慢两个指针，快指针每次走两步，慢指针每次走一步。

- 如果不含环，快指针会先遇到 `null`，说明链表不含环；
- 如果含有环，快指针最终会超慢指针一圈，和慢指针相遇，说明链表含有环。

```c++
class Solution {
public:
    bool hasCycle(ListNode *head) {
        ListNode *slow = head;
        ListNode *fast = head;
        while (fast && fast->next) {
            fast = fast->next->next;
            slow = slow->next;
            if (slow == fast) return true;
        }
        return false;
    }
};
```

#### 2）若链表中有环，求环的起始位置

[142-[环问题-环入口]-环形链表](./例题-双指针/142-[环问题-环入口]-环形链表.md)

当快慢指针相遇时，让其中任一个指针指向头节点，然后让它俩以相同的速度前进，再次相遇时所在的节点位置就是环开始的位置

下面的算法实现：

- 第一步找到慢指针 slow 和快指针 fast 在环内的相遇点
- 第二步将快指针重新指向head，fast 与 slow 以每次走一步的速度往前走

最后相遇的位置就是环的起始位置

```c++
class Solution {
public:
    ListNode *detectCycle(ListNode *head) {
        bool isLoop = false;
        ListNode *slow = head;
        ListNode *fast = head;
        while (fast && fast->next) {
            fast = fast->next->next;
            slow = slow->next;
            if (slow == fast) {
                isLoop = true;
                break;
            }
        }
        if (!isLoop) return NULL;

        fast = head;
        while (fast != slow) {
            fast = fast->next;
            slow = slow->next;
        }
        return slow;
    }
};
```





快慢双指针一定会相遇证明：Floyd 判圈算法

【补充】

## 二、前后双指针

### 1、寻找链表的倒数第 n 个元素

使用前后双指针，前面的指针先走 n 步，后面的指针开始同速前进。这样当前面的指针走到链表末尾`null`时，后面的指针所在的位置就是倒数第`n`个链表节点

具体实现上，需要先建个哨兵头节点，可以防止很多异常用例。

```c++
class Solution {
public:
    ListNode* removeNthFromEnd(ListNode* head, int n) {
        ListNode* hair = new ListNode(0, head);
        ListNode* front = head;
        ListNode* back = hair;
        for (int i = 0; i < n; i++) {
            front = front->next;
        }  // 此时 front 与 back 之间距离为 n + 2
        while (front != nullptr) {
            front = front->next;
            back = back->next;
        }
        // 此时 front 为原链表后的 null，back 指向删除节点的前一个
        back->next = back->next->next;
        return hair->next;
    }
};
```

例题：[19-[栈-前后双指针]-删除链表的倒数第N个结点](../1-数据结构/例题-链表/19-[栈-前后双指针]-删除链表的倒数第N个结点.md)

### 2、数据有序，相同元素最多保留 k 位 问题

- 对于前 k 个数字，直接保留
- 对于 k 个后面的数字，**与当前写入的位置，从后往前数的第 k 个元素进行比较，不相同则保留**

**此方法的正确性根源为：「数据有序」**

例题：[26-80-[数据有序-相同元素最多保留k位]-删除数组中的重复项](./例题-双指针/26-80-[数据有序-相同元素最多保留k位]-删除数组中的重复项.md)

## 三、左右双指针

左右指针在数组中实际是指两个索引值，一般初始化为`left = 0, right = nums.length - 1`

一般情况下要求原始数组是有序的，但是无序的数组也可应用

### 1、二分

二分算法其实就是左右双指针

### 2、两数之和

在有序数组中，left = 0 指向最小的值，right = n - 1，指向最大的值

- 如果当前值比 target 小，left++
- 如果当前值比 taget 大，right--

```c++
class Solution {
public:
    vector<int> twoSum(vector<int>& numbers, int target) {
        int left = 0;
        int right = numbers.size() - 1;
        while (left < right) {
            int tmp = numbers[left] + numbers[right];
            if (tmp == target) {
                return {left, right};
            } else if (tmp < target) {
                left++;
            } else if (tmp > target) {
                right--;
            }
        }
        return {};
    }
};
```

例题：[167-[左右双指针-入门]-两数之和II](./例题-双指针/167-[左右双指针-入门]-两数之和II.md)

### 3、反转数组

- 如果数组长度为奇数，最后跳出循环时 left == right，不用交换
- 如果数组长度为偶数，最后跳出循环时 left > right，不用交换

```c++
class Solution {
public:
    void reverseString(vector<char>& s) {
        int left = 0;
        int right = s.size() - 1;
        while (left < right) {
            swap(s[left], s[right]);
            left++;
            right--;
        }
    }
};
```

例题：[344. 反转字符串](https://leetcode-cn.com/problems/reverse-string/)

### 4、滑动窗口

滑动窗口也是双指针

- 窗口右边的指针 right 控制元素进入窗口
- 窗口左边的指针 left 控制元素出窗口

## 四、指向各自集合的双指针

算法步骤：

- **将所有集合排序，进行数据预处理**
- 每个集合有自己的指针，并指向开头
- 循环条件为：所有的指针都在数据长度的范围内
- 在循环内部，指针指向元素的消耗，引起指针往后移动（要消耗的写在 if 里）

模版：

```c++
class Solution {
public:
    int findContentChildren(vector<int>& g, vector<int>& s) {
        // 尽量小的饼干，刚好满足胃口小的小孩
        sort(g.begin(), g.end());
        sort(s.begin(), s.end());
        int ans = 0;
        int ptr1 = 0, ptr2 = 0;  // ptr1指向小孩，ptr2指向饼干
        while (ptr1 < g.size() && ptr2 < s.size()) {
            // cout << ptr1 << " " << ptr2 << endl;
            if (s[ptr2] >= g[ptr1]) { // 将必须要消耗的写在 if 里，并计数
                ans++;
                ptr1++;  // 消耗掉一个小孩，往后指一位
            }
            ptr2++;  // 消耗掉一个饼干，或当前饼干小了，都往后指
        }
        return ans;
    }
};
```



另一种情况

```c++
int i = s.length() - 1;
int j = t.length() - 1;

while (true) {
    while (i >= 0) {
        if (找到想要的值) {
            break;
        } else {
            i--;
        }
    }
    // 此时 i 指向 s 中想要的值
    while (j >= 0) {
        if (找到想要的值) {
            break;
        } else {
            j--;
        }
    }
    // 此时 j 指向 t 中想要的值
    if (i >= 0 && j >= 0) {  // 都大于等于0
        if (s[i] != t[j]) {
            return false;
        }
    } else {                       // 其中一个小于零 或 都小于零
        if (i == -1 && j == -1) {  // 同时到达 -1 时，返回 True
            return true;
        } else {
            return false;
        }
    }
    i--, j--;
}
return true;  // 逻辑不会走到这里

```



## 五、例题

| 题解                                                         | 难度                                                         | 推荐指数 |       |
| ------------------------------------------------------------ | ------------------------------------------------------------ | -------- | ----- |
|                                                              |                                                              |          |       |
| [11. 盛最多水的容器](https://leetcode-cn.com/problems/container-with-most-water/) | [LeetCode 题解链接](https://leetcode-cn.com/problems/container-with-most-water/solution/shua-chuan-lc-shuang-zhi-zhen-tan-xin-ji-52gf/) | 中等     | 🤩🤩🤩🤩🤩 |
| [15. 三数之和](https://leetcode-cn.com/problems/3sum/)       | [LeetCode 题解链接](https://leetcode-cn.com/problems/3sum/solution/shua-chuan-lc-pai-xu-shuang-zhi-zhen-jie-cd8r/) | 中等     | 🤩🤩🤩🤩🤩 |
| [16. 最接近的三数之和](https://leetcode-cn.com/problems/3sum-closest/) | [LeetCode 题解链接](https://leetcode-cn.com/problems/3sum-closest/solution/shua-chuan-lc-pai-xu-shuang-zhi-zhen-jie-p2ou/) | 中等     | 🤩🤩🤩🤩  |
| [18. 四数之和](https://leetcode-cn.com/problems/4sum/)       | [LeetCode 题解链接](https://leetcode-cn.com/problems/4sum/solution/shua-chuan-lc-pai-xu-shuang-zhi-zhen-jie-dqx7/) | 中等     | 🤩🤩🤩🤩  |
| [19. 删除链表的倒数第 N 个结点](https://leetcode-cn.com/problems/remove-nth-node-from-end-of-list/) | [LeetCode 题解链接](https://leetcode-cn.com/problems/remove-nth-node-from-end-of-list/solution/shua-chuan-lc-lian-biao-kuai-man-zhi-zhe-1gs1/) | 中等     | 🤩🤩🤩🤩🤩 |
| [26. 删除有序数组中的重复项](https://leetcode-cn.com/problems/remove-duplicates-from-sorted-array/) | [LeetCode 题解链接](https://leetcode-cn.com/problems/remove-duplicates-from-sorted-array/solution/shua-chuan-lc-jian-ji-shuang-zhi-zhen-ji-2eg8) | 简单     | 🤩🤩🤩🤩  |
| [27. 移除元素](https://leetcode-cn.com/problems/remove-element/) | [LeetCode 题解链接](https://leetcode-cn.com/problems/remove-element/solution/shua-chuan-lc-shuang-bai-shuang-zhi-zhen-mzt8/) | 简单     | 🤩🤩🤩🤩  |
| [45. 跳跃游戏 II](https://leetcode-cn.com/problems/jump-game-ii/) | [LeetCode 题解链接](https://leetcode-cn.com/problems/jump-game-ii/solution/xiang-jie-dp-tan-xin-shuang-zhi-zhen-jie-roh4/) | 中等     | 🤩🤩🤩🤩  |
| [88. 合并两个有序数组](https://leetcode-cn.com/problems/merge-sorted-array/) | [LeetCode 题解链接](https://leetcode-cn.com/problems/merge-sorted-array/solution/gong-shui-san-xie-yi-ti-san-jie-shuang-z-47gj/) | 简单     | 🤩🤩🤩   |
| [345. 反转字符串中的元音字母](https://leetcode-cn.com/problems/reverse-vowels-of-a-string/) | [LeetCode 题解链接](https://leetcode-cn.com/problems/reverse-vowels-of-a-string/solution/gong-shui-san-xie-note-bie-pian-shuang-z-c8ii/) | 简单     | 🤩🤩🤩   |
| [395. 至少有 K 个重复字符的最长子串](https://leetcode-cn.com/problems/longest-substring-with-at-least-k-repeating-characters/) | [LeetCode 题解链接](https://leetcode-cn.com/problems/longest-substring-with-at-least-k-repeating-characters/solution/xiang-jie-mei-ju-shuang-zhi-zhen-jie-fa-50ri1/) | 中等     | 🤩🤩🤩   |
| [413. 等差数列划分](https://leetcode-cn.com/problems/arithmetic-slices/) | [LeetCode 题解链接](https://leetcode-cn.com/problems/arithmetic-slices/solution/gong-shui-san-xie-shuang-zhi-zhen-qiu-ji-ef1q/) | 中等     | 🤩🤩🤩🤩  |
| [424. 替换后的最长重复字符](https://leetcode-cn.com/problems/longest-repeating-character-replacement/) | [LeetCode 题解链接](https://leetcode-cn.com/problems/longest-repeating-character-replacement/solution/ping-ping-wu-qi-shuang-zhi-zhen-da-bai-h-fgif/) | 中等     | 🤩🤩🤩🤩  |
| [438. 找到字符串中所有字母异位词](https://leetcode-cn.com/problems/find-all-anagrams-in-a-string/) | [LeetCode 题解链接](https://leetcode-cn.com/problems/find-all-anagrams-in-a-string/solution/gong-shui-san-xie-shuang-zhi-zhen-shi-xi-t5hc/) | 中等     | 🤩🤩🤩🤩  |
| [443. 压缩字符串](https://leetcode-cn.com/problems/string-compression/) | [LeetCode 题解链接](https://leetcode-cn.com/problems/string-compression/solution/gong-shui-san-xie-shuang-zhi-zhen-yuan-d-bppu/) | 中等     | 🤩🤩🤩🤩  |
| [475. 供暖器](https://leetcode-cn.com/problems/heaters/)     | [LeetCode 题解链接](https://leetcode-cn.com/problems/heaters/solution/gong-shui-san-xie-er-fen-shuang-zhi-zhen-mys4/) | 中等     | 🤩🤩🤩🤩  |
| [485. 最大连续 1 的个数](https://leetcode-cn.com/problems/max-consecutive-ones/) | [LeetCode 题解链接](https://leetcode-cn.com/problems/max-consecutive-ones/solution/you-shi-yi-tian-gao-pin-jian-dan-ti-ni-d-avj1/) | 简单     | 🤩🤩🤩🤩  |
| [519. 随机翻转矩阵](https://leetcode-cn.com/problems/random-flip-matrix/) | [LeetCode 题解链接](https://leetcode-cn.com/problems/random-flip-matrix/solution/gong-shui-san-xie-note-bie-pian-yi-ti-sh-e6gi/) | 中等     | 🤩🤩🤩🤩  |
| [524. 通过删除字母匹配到字典里最长单词](https://leetcode-cn.com/problems/longest-word-in-dictionary-through-deleting/) | [LeetCode 题解链接](https://leetcode-cn.com/problems/longest-word-in-dictionary-through-deleting/solution/gong-shui-san-xie-xiang-jie-pai-xu-shuan-qi20/) | 中等     | 🤩🤩🤩🤩  |
| [581. 最短无序连续子数组](https://leetcode-cn.com/problems/shortest-unsorted-continuous-subarray/) | [LeetCode 题解链接](https://leetcode-cn.com/problems/shortest-unsorted-continuous-subarray/solution/gong-shui-san-xie-yi-ti-shuang-jie-shuan-e1le/) | 中等     | 🤩🤩🤩🤩  |
| [594. 最长和谐子序列](https://leetcode-cn.com/problems/longest-harmonious-subsequence/) | [LeetCode 题解链接](https://leetcode-cn.com/problems/longest-harmonious-subsequence/solution/gong-shui-san-xie-yi-ti-shuang-jie-hua-d-quuh/) | 简单     | 🤩🤩🤩🤩  |
| [611. 有效三角形的个数](https://leetcode-cn.com/problems/valid-triangle-number/) | [LeetCode 题解链接](https://leetcode-cn.com/problems/valid-triangle-number/solution/gong-shui-san-xie-yi-ti-san-jie-jian-dan-y1we/) | 中等     | 🤩🤩🤩🤩  |
| [633. 平方数之和](https://leetcode-cn.com/problems/sum-of-square-numbers/) | [LeetCode 题解链接](https://leetcode-cn.com/problems/sum-of-square-numbers/solution/gong-shui-san-xie-yi-ti-san-jie-mei-ju-s-7qi5/) | 简单     | 🤩🤩    |
| [786. 第 K 个最小的素数分数](https://leetcode-cn.com/problems/k-th-smallest-prime-fraction/) | [LeetCode 题解链接](https://leetcode-cn.com/problems/k-th-smallest-prime-fraction/solution/gong-shui-san-xie-yi-ti-shuang-jie-you-x-8ymk/) | 中等     | 🤩🤩🤩   |
| [825. 适龄的朋友](https://leetcode-cn.com/problems/friends-of-appropriate-ages/) | [LeetCode 题解链接](https://leetcode-cn.com/problems/friends-of-appropriate-ages/solution/gong-shui-san-xie-yi-ti-shuang-jie-pai-x-maa8/) | 中等     | 🤩🤩🤩🤩  |
| [832. 翻转图像](https://leetcode-cn.com/problems/flipping-an-image/) | [LeetCode 题解链接](https://leetcode-cn.com/problems/flipping-an-image/solution/shuang-zhi-zhen-yi-bian-chu-li-huan-you-ik0v1/) | 简单     | 🤩🤩    |
| [838. 推多米诺](https://leetcode-cn.com/problems/push-dominoes/) | [LeetCode 题解链接](https://leetcode-cn.com/problems/push-dominoes/solution/gong-shui-san-xie-yi-ti-shuang-jie-bfs-y-z52w/) | 中等     | 🤩🤩🤩🤩  |
| [881. 救生艇](https://leetcode-cn.com/problems/boats-to-save-people/) | [LeetCode 题解链接](https://leetcode-cn.com/problems/boats-to-save-people/solution/gong-shui-san-xie-noxiang-xin-ke-xue-xi-hosg8/) | 中等     | 🤩🤩🤩🤩  |
| [917. 仅仅反转字母](https://leetcode-cn.com/problems/reverse-only-letters/) | [LeetCode 题解链接](https://leetcode-cn.com/problems/reverse-only-letters/solution/gong-shui-san-xie-jian-dan-shuang-zhi-zh-xrpt/) | 简单     | 🤩🤩🤩🤩  |
| [930. 和相同的二元子数组](https://leetcode-cn.com/problems/binary-subarrays-with-sum/) | [LeetCode 题解链接](https://leetcode-cn.com/problems/binary-subarrays-with-sum/solution/gong-shui-san-xie-yi-ti-shuang-jie-qian-hfoc0/) | 中等     | 🤩🤩🤩   |
| [992. K 个不同整数的子数组](https://leetcode-cn.com/problems/subarrays-with-k-different-integers/) | [LeetCode 题解链接](https://leetcode-cn.com/problems/subarrays-with-k-different-integers/solution/miao-dong-xi-lie-xiang-jie-shuang-zhi-zh-9k8w/) | 困难     | 🤩🤩🤩🤩  |
| [1004. 最大连续1的个数 III](https://leetcode-cn.com/problems/max-consecutive-ones-iii/) | [LeetCode 题解链接](https://leetcode-cn.com/problems/max-consecutive-ones-iii/solution/san-chong-jie-fa-cong-dong-tai-gui-hua-d-gxks/) | 中等     | 🤩🤩🤩   |
| [1052. 爱生气的书店老板](https://leetcode-cn.com/problems/grumpy-bookstore-owner/) | [LeetCode 题解链接](https://leetcode-cn.com/problems/grumpy-bookstore-owner/solution/hua-dong-chuang-kou-luo-ti-by-ac_oier-nunu/) | 中等     | 🤩🤩🤩   |
| [1221. 分割平衡字符串](https://leetcode-cn.com/problems/split-a-string-in-balanced-strings/) | [LeetCode 题解链接](https://leetcode-cn.com/problems/split-a-string-in-balanced-strings/solution/gong-shui-san-xie-noxiang-xin-ke-xue-xi-wumnk/) | 简单     | 🤩🤩🤩🤩  |
| [1332. 删除回文子序列](https://leetcode-cn.com/problems/remove-palindromic-subsequences/) | [LeetCode 题解链接](https://leetcode-cn.com/problems/remove-palindromic-subsequences/solution/gong-shui-san-xie-jian-dan-mo-ni-ti-by-a-0zwn/) | 中等     | 🤩🤩🤩🤩  |
| [1446. 连续字符](https://leetcode-cn.com/problems/consecutive-characters/) | [LeetCode 题解链接](https://leetcode-cn.com/problems/consecutive-characters/solution/gong-shui-san-xie-jian-dan-shuang-zhi-zh-xtv6/) | 简单     | 🤩🤩🤩🤩🤩 |
| [1610. 可见点的最大数目](https://leetcode-cn.com/problems/maximum-number-of-visible-points/) | [LeetCode 题解链接](https://leetcode-cn.com/problems/maximum-number-of-visible-points/solution/gong-shui-san-xie-qiu-ji-jiao-ji-he-ti-b-0bid/) | 困难     | 🤩🤩🤩🤩  |
| [1743. 从相邻元素对还原数组](https://leetcode-cn.com/problems/restore-the-array-from-adjacent-pairs/) | [LeetCode 题解链接](https://leetcode-cn.com/problems/restore-the-array-from-adjacent-pairs/solution/gong-shui-san-xie-yi-ti-shuang-jie-dan-x-elpx/) | 中等     | 🤩🤩🤩🤩  |
| [1748. 唯一元素的和](https://leetcode-cn.com/problems/sum-of-unique-elements/) | [LeetCode 题解链接](https://leetcode-cn.com/problems/sum-of-unique-elements/solution/gong-shui-san-xie-yi-ti-shuang-jie-pai-x-atnd/) | 简单     | 🤩🤩🤩🤩  |
| [1764. 通过连接另一个数组的子数组得到一个数组](https://leetcode-cn.com/problems/form-array-by-concatenating-subarrays-of-another-array/) | [LeetCode 题解链接](https://leetcode-cn.com/problems/form-array-by-concatenating-subarrays-of-another-array/solution/clean-solutionni-jue-dui-neng-kan-dong-d-l4ts/) | 中等     | 🤩🤩🤩🤩  |
| [2000. 反转单词前缀](https://leetcode-cn.com/problems/reverse-prefix-of-word/) | [LeetCode 题解链接](https://leetcode-cn.com/problems/reverse-prefix-of-word/solution/gong-shui-san-xie-jian-dan-shuang-zhi-zh-dp9u/) | 简单     | 🤩🤩🤩🤩  |
| [2047. 句子中的有效单词数](https://leetcode-cn.com/problems/number-of-valid-words-in-a-sentence/) | [LeetCode 题解链接](https://leetcode-cn.com/problems/number-of-valid-words-in-a-sentence/solution/gong-shui-san-xie-jian-dan-zi-fu-chuan-m-5pcz/) | 简单     | 🤩🤩🤩🤩  |
